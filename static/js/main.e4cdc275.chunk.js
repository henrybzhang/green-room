(this.webpackJsonpgame=this.webpackJsonpgame||[]).push([[0],{18:function(e,t,c){},20:function(e,t,c){},21:function(e,t,c){},22:function(e,t,c){},23:function(e,t,c){},24:function(e,t,c){},25:function(e,t,c){"use strict";c.r(t);var r=c(0),a=c.n(r),n=c(9),i=c.n(n),s=(c(18),c(3)),b=c(2),o=c(1),u=Object(r.createContext)();function l(e){var t=e.children,c=Object(r.useState)({}),a=Object(s.a)(c,2),n=a[0],i=a[1],l=Object(r.useState)({}),j=Object(s.a)(l,2),d=j[0],O=j[1],h=function(e){var t=Object(b.a)({},n);Object.entries(e).forEach((function(e){var c=Object(s.a)(e,2),r=c[0],a=c[1];r in t?t[r]+=a:t[r]=a})),i(t)},f=Object(r.useMemo)((function(){return{playerItems:n,playerStructures:d,setPlayerStructures:O,updateItems:h}}),[n,d]);return Object(o.jsx)(u.Provider,{value:f,children:t})}c(20);var j=function(){var e=Object(r.useContext)(u).playerItems;return Object(o.jsxs)("fieldset",{className:"inventory-container",children:[Object(o.jsx)("legend",{children:"Collection"}),Object.entries(e).map((function(e){var t=Object(s.a)(e,2),c=t[0],r=t[1];return Object(o.jsxs)("div",{className:"inventory-item",children:[Object(o.jsxs)("div",{children:[c,":\xa0"]}),Object(o.jsx)("div",{className:"item-count",children:r})]},c)}))]})},d=c(4),O=Object(r.createContext)(),h={pickUpTrash:"Pick up trash"},f={recycler:{metal:-1},airFilter:{wood:-1},net:{plastic:-1},bridge:{wood:-1,metal:-1}},p=["trash","wood","metal","plastic"],v=["trash","plastic"],m=["wood","metal","plastic"],k=new Set(["pickUpTrash","buildRecycler","useRecycler","buildAirFilter","buildNet","useNet","buildBridge"]);function x(e){var t=e.children,c=Object(r.useContext)(u),a=c.playerItems,n=c.updateItems,i=c.playerStructures,l=c.setPlayerStructures,j=Object(r.useState)(null),x=Object(s.a)(j,2),y=x[0],g=x[1],N=Object(r.useState)(h),w=Object(s.a)(N,2),C=w[0],S=w[1],A=Object(r.useState)({}),E=Object(s.a)(A,2),F=E[0],T=E[1],U=Object(r.useState)(1),M=Object(s.a)(U,2),R=M[0],I=M[1],P=function(e){var t=!1;return Object.entries(f[e]).forEach((function(e){var c=Object(s.a)(e,2),r=c[0],n=c[1];a[r]+n>=0&&(t=!0)})),t};Object(r.useEffect)((function(){if(y){try{if(!k.has(y))throw Error("Unknown action: ".concat(y));switch(y){case"pickUpTrash":var e=p[Math.floor(Math.random()*p.length)];n(Object(d.a)({},e,1));break;case"buildRecycler":l(Object(b.a)(Object(b.a)({},i),{},{recycler:!0})),n(f.recycler);break;case"useRecycler":var t,c=m[Math.floor(Math.random()*m.length)];n((t={},Object(d.a)(t,c,1),Object(d.a)(t,"trash",-1),t));break;case"buildAirFilter":l(Object(b.a)(Object(b.a)({},i),{},{airFilter:!0})),n(f.airFilter);break;case"buildNet":l(Object(b.a)(Object(b.a)({},i),{},{net:!0})),n(f.net);break;case"useNet":var r=v[Math.floor(Math.random()*v.length)];n(Object(d.a)({},r,1));break;case"buildBridge":l(Object(b.a)(Object(b.a)({},i),{},{bridge:!0})),n(f.bridge);break;default:throw Error("Undeveloped action: ".concat(y))}T((a=y)in F?Object(b.a)(Object(b.a)({},F),{},Object(d.a)({},a,F[a]+1)):Object(b.a)(Object(b.a)({},F),{},Object(d.a)({},a,1)))}catch(s){console.log(s)}var a;g(null)}}),[y]),Object(r.useEffect)((function(){S(Object(b.a)(Object(b.a)(Object(b.a)(Object(b.a)(Object(b.a)(Object(b.a)({pickUpTrash:"Pick up trash"},P("recycler")&&!i.recycler&&{buildRecycler:"Fix recycler"}),a.trash&&i.recycler&&{useRecycler:"Recycle trash"}),P("airFilter")&&!i.airFilter&&i.recycler&&{buildAirFilter:"Construct air filter"}),P("net")&&3===R&&{buildNet:"Construct river net"}),i.net&&{useNet:"Filter river trash"}),P("bridge")&&4===R&&{buildBridge:"Construct a bridge"}))}),[a,R,i]),Object(r.useEffect)((function(){var e=R;if(1===R&&F.pickUpTrash>=10)e=2;else if(2===R&&F.pickUpTrash>=10&&i.airFilter)e=3;else if(3===R&&F.useNet>=5)e=4;else if(4===R&&i.bridge)e=5;else{if(!(5===R&&F.pickUpTrash>=10))return;e=6}T({}),I(e)}),[i,R,F]);var B=Object(r.useMemo)((function(){return{currentAction:y,environmentLevel:R,availableActions:C,setCurrentAction:g}}),[y,R,C]);return Object(o.jsx)(O.Provider,{value:B,children:t})}c(21);var y=function(e){var t=e.actionName,c=e.actionText,a=Object(r.useContext)(O).setCurrentAction;return Object(o.jsx)("button",{type:"button",className:"buttons shrink-on-hover",onClick:function(){return a(t)},children:c})};c(22);var g=function(){var e=Object(r.useContext)(O).availableActions;return Object(o.jsx)("div",{className:"buttons-group",children:Object.entries(e).map((function(e){var t=Object(s.a)(e,2),c=t[0],r=t[1];return Object(o.jsx)(y,{actionName:c,actionText:r},c)}))})},N=c(5);c(23);var w=function(){var e=Object(r.useContext)(O).currentAction,t=Object(r.useState)([]),c=Object(s.a)(t,2),a=c[0],n=c[1];return Object(r.useEffect)((function(){if(e)try{if(!k.has(e))throw Error("Unknown action: ".concat(e));switch(e){case"pickUpTrash":n(["Some trash from the ground is picked up"].concat(Object(N.a)(a)));break;case"buildRecycler":n(["The recycler is now operational"].concat(Object(N.a)(a)));break;case"useRecycler":n(["Some trash is recycled into usable items"].concat(Object(N.a)(a)));break;case"buildAirFilterv":n(["An air filter has been constructed"].concat(Object(N.a)(a)));break;case"buildNet":n(["A net has been built"].concat(Object(N.a)(a)));break;case"useNet":n(["Some litter is filtered from the river"].concat(Object(N.a)(a)));break;case"buildBridge":n(["The river can now be crossed"].concat(Object(N.a)(a)));break;default:throw Error("Undeveloped action: ".concat(e))}}catch(t){console.log(t)}}),[e]),Object(o.jsx)("div",{className:"log",children:a.map((function(e,t){return Object(o.jsx)("div",{style:{opacity:(20-t)/20},children:e},t)}))})},C=c.p+"static/media/1.e6b114f3.jpeg",S=c.p+"static/media/2.e1e3d8fd.jpeg",A=c.p+"static/media/3.9f993332.jpeg",E=c.p+"static/media/4.6d634823.jpeg",F=c.p+"static/media/5.8148bb66.gif",T=c.p+"static/media/6.2050b749.gif",U=Object(r.createContext)();function M(e){var t=e.children,c=Object(r.useContext)(O).environmentLevel,a=Object(r.useState)(C),n=Object(s.a)(a,2),i=n[0],b=n[1];Object(r.useEffect)((function(){switch(c){case 1:b(C);break;case 2:b(S);break;case 3:b(A);break;case 4:b(E);break;case 5:b(F);break;case 6:b(T)}}),[c]);var u=Object(r.useMemo)((function(){return{backgroundImage:i}}),[i]);return Object(o.jsx)(U.Provider,{value:u,children:t})}c(24);var R=function(){var e=Object(r.useContext)(U).backgroundImage;return Object(o.jsx)("div",{className:"app",style:{backgroundImage:"url(".concat(e,")")},children:Object(o.jsxs)("div",{className:"content",children:[Object(o.jsx)(w,{}),Object(o.jsx)(g,{}),Object(o.jsx)(j,{})]})})};i.a.createRoot(document.getElementById("root")).render(Object(o.jsx)(a.a.StrictMode,{children:Object(o.jsx)(l,{children:Object(o.jsx)(x,{children:Object(o.jsx)(M,{children:Object(o.jsx)(R,{})})})})}))}},[[25,1,2]]]);
//# sourceMappingURL=main.e4cdc275.chunk.js.map