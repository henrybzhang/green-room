(this.webpackJsonpgame=this.webpackJsonpgame||[]).push([[0],{18:function(e,t,r){},20:function(e,t,r){},21:function(e,t,r){},22:function(e,t,r){},23:function(e,t,r){},24:function(e,t,r){},25:function(e,t,r){"use strict";r.r(t);var c=r(0),a=r.n(c),n=r(8),i=r.n(n),s=(r(18),r(2)),o=r(3),l=r(1),b=Object(c.createContext)();function u(e){var t=e.children,r=Object(c.useState)({}),a=Object(s.a)(r,2),n=a[0],i=a[1],u=Object(c.useState)({}),j=Object(s.a)(u,2),d=j[0],O=j[1],h=function(e){var t=Object(o.a)({},n);Object.entries(e).forEach((function(e){var r=Object(s.a)(e,2),c=r[0],a=r[1];c in t?t[c]+=a:t[c]=a})),i(t)},f=Object(c.useMemo)((function(){return{playerItems:n,playerStructures:d,setPlayerStructures:O,updateItems:h}}),[n,d]);return Object(l.jsx)(b.Provider,{value:f,children:t})}var j=r(4),d=Object(c.createContext)();function O(e){var t=e.children,r=Object(c.useState)(!1),a=Object(s.a)(r,2),n=a[0],i=a[1],o=Object(c.useMemo)((function(){return{debug:n,setDebug:i}}),[n]);return Object(l.jsx)(d.Provider,{value:o,children:t})}var h=Object(c.createContext)(),f={pickUpTrash:"Pick up trash"},v={recycler:{metal:-2},airFilter:{wood:-2,plastic:-2},net:{plastic:-2},bridge:{wood:-5,metal:-5}},m={recycler:{metal:-1},airFilter:{wood:-1,plastic:-1},net:{plastic:-1},bridge:{wood:-1,metal:-1}},g=["trash","wood","metal","plastic"],p=["trash","plastic"],x=["wood","metal","plastic"],y=new Set(["pickUpTrash","buildRecycler","useRecycler","buildAirFilter","plantSeeds","buildNet","useNet","buildBridge"]);function k(e){var t=e.children,r=Object(c.useContext)(b),a=r.playerItems,n=r.updateItems,i=r.playerStructures,u=r.setPlayerStructures,O=Object(c.useContext)(d).debug,k=Object(c.useState)(null),C=Object(s.a)(k,2),S=C[0],T=C[1],w=Object(c.useState)(f),N=Object(s.a)(w,2),F=N[0],E=N[1],M=Object(c.useState)({}),A=Object(s.a)(M,2),R=A[0],I=A[1],P=Object(c.useState)(1),U=Object(s.a)(P,2),B=U[0],L=U[1],D=Object(c.useState)(null),J=Object(s.a)(D,2),W=J[0],q=J[1],z=O?m:v,G=function(e){var t=!0;return Object.entries(z[e]).forEach((function(e){var r=Object(s.a)(e,2),c=r[0],n=r[1];(!a[c]||a[c]+n<0)&&(t=!1)})),t};Object(c.useEffect)((function(){if(S){try{if(!y.has(S))throw Error("Unknown action: ".concat(S));switch(S){case"pickUpTrash":var e=g[Math.floor(Math.random()*g.length)],t="The surrounding area has been slightly cleared of trash";"trash"!==e&&(t="Clearing some trash has provided some useful ".concat(e)),q(t),n(Object(j.a)({},e,1));break;case"buildRecycler":u(Object(o.a)(Object(o.a)({},i),{},{recycler:!0})),q("The recycler is now operational"),n(z.recycler);break;case"useRecycler":var r,c=x[Math.floor(Math.random()*x.length)];q("Some ".concat(c," has been recycled from trash")),n((r={},Object(j.a)(r,c,1),Object(j.a)(r,"trash",-1),r));break;case"buildAirFilter":u(Object(o.a)(Object(o.a)({},i),{},{airFilter:!0})),q("An air filter has begun to reduce the amount of smog in the air"),n(z.airFilter);break;case"plantSeeds":q("The beginnings of new life have been planted");break;case"buildNet":u(Object(o.a)(Object(o.a)({},i),{},{net:!0})),q("Removing trash from the disgusting river is now a possibility"),n(z.net);break;case"useNet":var a=p[Math.floor(Math.random()*p.length)];n(Object(j.a)({},a,1)),q("Some ".concat(a," has been removed from the river"));break;case"buildBridge":u(Object(o.a)(Object(o.a)({},i),{},{bridge:!0})),n(z.bridge),q("The river can now be crossed");break;default:throw Error("Undeveloped action: ".concat(S))}I((s=S)in R?Object(o.a)(Object(o.a)({},R),{},Object(j.a)({},s,R[s]+1)):Object(o.a)(Object(o.a)({},R),{},Object(j.a)({},s,1)))}catch(l){console.log(l)}var s;T(null)}}),[S,B]),Object(c.useEffect)((function(){E(7!==B?Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)({pickUpTrash:"Pick up trash"},G("recycler")&&!i.recycler&&{buildRecycler:"Fix recycler"}),a.trash&&i.recycler&&{useRecycler:"Recycle trash"}),G("airFilter")&&!i.airFilter&&i.recycler&&2===B&&{buildAirFilter:"Construct air filter"}),3===B&&{plantSeeds:"Plant seeds"}),G("net")&&!i.net&&4===B&&{buildNet:"Construct river net"}),i.net&&4===B&&{useNet:"Filter river trash"}),G("bridge")&&5===B&&{buildBridge:"Construct a bridge"}):{})}),[a,B,i]),Object(c.useEffect)((function(){var e=B;if(1===B&&R.pickUpTrash>=3)e=2,q("Clearing trash has provided some breathing room");else if(2===B&&R.pickUpTrash>=3&&i.airFilter)e=3,q("This side of the river has been cleared of trash");else if(3===B&&R.plantSeeds)e=4;else if(4===B&&R.useNet>=3)q("The river now looks like a river again"),e=5;else if(5===B&&i.bridge)e=6;else{if(!(6===B&&R.pickUpTrash>=3))return;e=7,q("The area has been completely cleared of trash and pollution. Nature is finally beginning to recover.")}I({}),L(e)}),[i,B,R]);var H=Object(c.useMemo)((function(){return{currentAction:S,environmentLevel:B,availableActions:F,nextText:W,setNextText:q,setCurrentAction:T}}),[S,B,F,W]);return Object(l.jsx)(h.Provider,{value:H,children:t})}r(20);var C=function(){var e=Object(c.useContext)(b).playerItems;return 7===Object(c.useContext)(h).environmentLevel?null:Object(l.jsxs)("fieldset",{className:"inventory-container",children:[Object(l.jsx)("legend",{children:"Collection"}),Object.entries(e).map((function(e){var t=Object(s.a)(e,2),r=t[0],c=t[1];return Object(l.jsxs)("div",{className:"inventory-item",children:[Object(l.jsxs)("div",{children:[r,":\xa0"]}),Object(l.jsx)("div",{className:"item-count",children:c})]},r)}))]})};r(21);var S=function(e){var t=e.actionName,r=e.actionText,a=Object(c.useContext)(h).setCurrentAction,n=Object(c.useContext)(d).debug,i=Object(c.useState)(!1),o=Object(s.a)(i,2),b=o[0],u=o[1];return Object(l.jsx)("button",{type:"button",className:"buttons ".concat(b?"disabled":"shrink-on-hover"),onClick:function(){n||(u(!0),setTimeout((function(){u(!1)}),1e3)),a(t)},disabled:b,children:r})};r(22);var T=function(){var e=Object(c.useContext)(h).availableActions,t=Object(c.useState)(!1),r=Object(s.a)(t,2),a=r[0],n=r[1];return Object(c.useEffect)((function(){var e=setTimeout((function(){n(!0)}),2500);return function(){return clearTimeout(e)}}),[]),Object(l.jsx)("div",{className:"buttons-group",style:{transition:"all 2s",visibility:a?"visible":"hidden",opacity:a?"1":"0"},children:Object.entries(e).map((function(e){var t=Object(s.a)(e,2),r=t[0],c=t[1];return Object(l.jsx)(S,{actionName:r,actionText:c},r)}))})},w=r(9),N=(r(23),["Welcome to a recovering world","The surrounding area is piled high with trash and is extremely polluted. Smog covers the land, making the visibility almost nil."]);var F=function(){var e=Object(c.useContext)(h),t=e.nextText,r=e.setNextText,a=e.environmentLevel,n=Object(c.useState)(N),i=Object(s.a)(n,2),o=i[0],b=i[1];return Object(c.useEffect)((function(){if(t){var e=o;7===a&&(e=[]),b([t].concat(Object(w.a)(e))),r(null)}}),[t]),Object(l.jsx)("div",{className:"log",children:o.map((function(e,t){return Object(l.jsx)("div",{children:e},t)}))})},E=Object(c.createContext)();function M(e){var t=e.children,r=Object(c.useContext)(h).environmentLevel,a=Object(c.useState)("1.jpeg"),n=Object(s.a)(a,2),i=n[0],o=n[1];Object(c.useEffect)((function(){switch(r){case 1:o("start.jpeg");break;case 2:o("initialClear.jpeg");break;case 3:o("builtAirFilter.jpeg");break;case 4:o("plantSeeds.jpeg");break;case 5:o("cleanRiver.jpeg");break;case 6:o("builtBridge.gif");break;case 7:o("final.gif")}}),[r]);var b=Object(c.useMemo)((function(){return{backgroundImage:i}}),[i]);return Object(l.jsx)(E.Provider,{value:b,children:t})}r(24);var A=function(){var e=Object(c.useContext)(E).backgroundImage,t=Object(c.useContext)(d),r=t.setDebug,a=t.debug;return Object(l.jsxs)("div",{className:"app",style:{backgroundImage:"url(".concat("/green-room","/images/").concat(e,")")},children:[Object(l.jsx)("button",{type:"button",className:"debug",onClick:function(){return r(!a)},children:"Debug"}),Object(l.jsxs)("div",{className:"content",children:[Object(l.jsx)(F,{}),Object(l.jsx)(T,{}),Object(l.jsx)(C,{})]})]})};i.a.createRoot(document.getElementById("root")).render(Object(l.jsx)(a.a.StrictMode,{children:Object(l.jsx)(O,{children:Object(l.jsx)(u,{children:Object(l.jsx)(k,{children:Object(l.jsx)(M,{children:Object(l.jsx)(A,{})})})})})}))}},[[25,1,2]]]);
//# sourceMappingURL=main.04d72f0b.chunk.js.map