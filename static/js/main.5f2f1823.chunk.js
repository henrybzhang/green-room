(this.webpackJsonpgame=this.webpackJsonpgame||[]).push([[0],{18:function(e,t,c){},20:function(e,t,c){},21:function(e,t,c){},22:function(e,t,c){},23:function(e,t,c){},24:function(e,t,c){},25:function(e,t,c){"use strict";c.r(t);var r=c(0),a=c.n(r),n=c(8),i=c.n(n),s=(c(18),c(2)),o=c(3),l=c(1),b=Object(r.createContext)();function u(e){var t=e.children,c=Object(r.useState)({}),a=Object(s.a)(c,2),n=a[0],i=a[1],u=Object(r.useState)({}),j=Object(s.a)(u,2),d=j[0],O=j[1],h=function(e){var t=Object(o.a)({},n);Object.entries(e).forEach((function(e){var c=Object(s.a)(e,2),r=c[0],a=c[1];r in t?t[r]+=a:t[r]=a})),i(t)},f=Object(r.useMemo)((function(){return{playerItems:n,playerStructures:d,setPlayerStructures:O,updateItems:h}}),[n,d]);return Object(l.jsx)(b.Provider,{value:f,children:t})}var j=c(4),d=Object(r.createContext)();function O(e){var t=e.children,c=Object(r.useState)(!1),a=Object(s.a)(c,2),n=a[0],i=a[1],o=Object(r.useMemo)((function(){return{debug:n,setDebug:i}}),[n]);return Object(l.jsx)(d.Provider,{value:o,children:t})}var h=Object(r.createContext)(),f={pickUpTrash:"Pick up trash"},v={recycler:{metal:-2},airFilter:{wood:-2,plastic:-2},net:{plastic:-2},bridge:{wood:-5,metal:-5}},m={recycler:{metal:-1},airFilter:{wood:-1,plastic:-1},net:{plastic:-1},bridge:{wood:-1,metal:-1}},p=["trash","wood","metal","plastic"],g=["trash","plastic"],x=["wood","metal","plastic"],y=new Set(["pickUpTrash","buildRecycler","useRecycler","buildAirFilter","plantSeeds","buildNet","useNet","buildBridge"]);function k(e){var t=e.children,c=Object(r.useContext)(b),a=c.playerItems,n=c.updateItems,i=c.playerStructures,u=c.setPlayerStructures,O=Object(r.useContext)(d).debug,k=Object(r.useState)(null),C=Object(s.a)(k,2),S=C[0],T=C[1],N=Object(r.useState)(f),w=Object(s.a)(N,2),F=w[0],E=w[1],M=Object(r.useState)({}),A=Object(s.a)(M,2),R=A[0],I=A[1],P=Object(r.useState)(1),U=Object(s.a)(P,2),B=U[0],D=U[1],L=Object(r.useState)(null),J=Object(s.a)(L,2),q=J[0],z=J[1],G=O?m:v,H=function(e){var t=!0;return Object.entries(G[e]).forEach((function(e){var c=Object(s.a)(e,2),r=c[0],n=c[1];(!a[r]||a[r]+n<0)&&(t=!1)})),t};Object(r.useEffect)((function(){if(S){try{if(!y.has(S))throw Error("Unknown action: ".concat(S));switch(S){case"pickUpTrash":var e=p[Math.floor(Math.random()*p.length)],t="The surrounding area has been slightly cleared of trash";"trash"!==e&&(t="Clearing some trash has provided some useful ".concat(e)),z(t),n(Object(j.a)({},e,1));break;case"buildRecycler":u(Object(o.a)(Object(o.a)({},i),{},{recycler:!0})),z("The recycler is now operational"),n(G.recycler);break;case"useRecycler":var c,r=x[Math.floor(Math.random()*x.length)];z("Some ".concat(r," has been recycled from trash")),n((c={},Object(j.a)(c,r,1),Object(j.a)(c,"trash",-1),c));break;case"buildAirFilter":u(Object(o.a)(Object(o.a)({},i),{},{airFilter:!0})),z("An air filter has begun to reduce the amount of smog in the air"),n(G.airFilter);break;case"plantSeeds":z("The beginnings of new life have been planted");break;case"buildNet":u(Object(o.a)(Object(o.a)({},i),{},{net:!0})),z("Removing trash from the disgusting river is now a possibility"),n(G.net);break;case"useNet":var a=g[Math.floor(Math.random()*g.length)];n(Object(j.a)({},a,1)),z("Some ".concat(a," has been removed from the river"));break;case"buildBridge":u(Object(o.a)(Object(o.a)({},i),{},{bridge:!0})),n(G.bridge),z("The river can now be crossed");break;default:throw Error("Undeveloped action: ".concat(S))}I((s=S)in R?Object(o.a)(Object(o.a)({},R),{},Object(j.a)({},s,R[s]+1)):Object(o.a)(Object(o.a)({},R),{},Object(j.a)({},s,1)))}catch(l){console.log(l)}var s;T(null)}}),[S,B]),Object(r.useEffect)((function(){E(7!==B?Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)({},(B<=2||6===B)&&{pickUpTrash:"Pick up trash"}),H("recycler")&&!i.recycler&&{buildRecycler:"Fix recycler"}),a.trash&&i.recycler&&{useRecycler:"Recycle trash"}),H("airFilter")&&!i.airFilter&&i.recycler&&2===B&&{buildAirFilter:"Construct air filter"}),3===B&&{plantSeeds:"Plant seeds"}),H("net")&&!i.net&&4===B&&{buildNet:"Construct river net"}),i.net&&4===B&&{useNet:"Filter river trash"}),H("bridge")&&5===B&&{buildBridge:"Construct a bridge"}):{})}),[a,B,i]),Object(r.useEffect)((function(){var e=B;if(1===B&&R.pickUpTrash>=3)e=2,z("Clearing trash has provided some breathing room");else if(2===B&&R.pickUpTrash>=3&&i.airFilter)e=3,z("This side of the river has been cleared of trash");else if(3===B&&R.plantSeeds)e=4;else if(4===B&&R.useNet>=3)z("The river now looks like a river again"),e=5;else if(5===B&&i.bridge)e=6;else{if(!(6===B&&R.pickUpTrash>=3))return;e=7,z("The area has been completely cleared of trash and pollution. Nature is finally beginning to recover.")}I({}),D(e)}),[i,B,R]);var K=Object(r.useMemo)((function(){return{currentAction:S,environmentLevel:B,availableActions:F,nextText:q,setNextText:z,setCurrentAction:T}}),[S,B,F,q]);return Object(l.jsx)(h.Provider,{value:K,children:t})}c(20);var C=function(){var e=Object(r.useContext)(b).playerItems;return 7===Object(r.useContext)(h).environmentLevel?null:Object(l.jsxs)("fieldset",{className:"inventory-container",children:[Object(l.jsx)("legend",{children:"Collection"}),Object.entries(e).map((function(e){var t=Object(s.a)(e,2),c=t[0],r=t[1];return Object(l.jsxs)("div",{className:"inventory-item",children:[Object(l.jsxs)("div",{children:[c,":\xa0"]}),Object(l.jsx)("div",{className:"item-count",children:r})]},c)}))]})};c(21);var S=function(e){var t=e.actionName,c=e.actionText,a=Object(r.useContext)(h).setCurrentAction,n=Object(r.useContext)(d).debug,i=Object(r.useState)(!1),o=Object(s.a)(i,2),b=o[0],u=o[1];return Object(l.jsx)("button",{type:"button",className:"buttons ".concat(b?"disabled":"shrink-on-hover"),onClick:function(){n||(u(!0),setTimeout((function(){u(!1)}),1e3)),a(t)},disabled:b,children:c})};c(22);var T=function(){var e=Object(r.useContext)(h).availableActions,t=Object(r.useState)(!1),c=Object(s.a)(t,2),a=c[0],n=c[1];return Object(r.useEffect)((function(){var e=setTimeout((function(){n(!0)}),2500);return function(){return clearTimeout(e)}}),[]),Object(l.jsx)("div",{className:"buttons-group",style:{transition:"all 2s",visibility:a?"visible":"hidden",opacity:a?"1":"0"},children:Object.entries(e).map((function(e){var t=Object(s.a)(e,2),c=t[0],r=t[1];return Object(l.jsx)(S,{actionName:c,actionText:r},c)}))})},N=c(9),w=(c(23),["The surrounding area is piled high with trash and is extremely polluted. Smog covers the land, making the visibility almost nil."]);var F=function(){var e=Object(r.useContext)(h),t=e.nextText,c=e.setNextText,a=Object(r.useState)(w),n=Object(s.a)(a,2),i=n[0],o=n[1];return Object(r.useEffect)((function(){t&&(o([t].concat(Object(N.a)(i.slice(0,20)))),c(null))}),[t]),Object(l.jsx)("div",{className:"log",children:i.map((function(e,t){return Object(l.jsx)("div",{style:{opacity:(20-t)/20},children:e},t)}))})},E=Object(r.createContext)();function M(e){var t=e.children,c=Object(r.useContext)(h).environmentLevel,a=Object(r.useState)("1.jpeg"),n=Object(s.a)(a,2),i=n[0],o=n[1];Object(r.useEffect)((function(){switch(c){case 1:o("start.jpeg");break;case 2:o("initialClear.jpeg");break;case 3:o("builtAirFilter.jpeg");break;case 4:o("plantSeeds.jpeg");break;case 5:o("cleanRiver.jpeg");break;case 6:o("builtBridge.gif");break;case 7:o("final.gif")}}),[c]);var b=Object(r.useMemo)((function(){return{backgroundImage:i}}),[i]);return Object(l.jsx)(E.Provider,{value:b,children:t})}c(24);var A=function(){var e=Object(r.useContext)(E).backgroundImage,t=Object(r.useContext)(d),c=t.setDebug,a=t.debug;return Object(l.jsxs)("div",{className:"app",style:{backgroundImage:"url(".concat("/green-room","/images/").concat(e,")")},children:[Object(l.jsx)("button",{type:"button",className:"debug",onClick:function(){return c(!a)},children:"Debug"}),Object(l.jsxs)("div",{className:"content",children:[Object(l.jsx)(F,{}),Object(l.jsx)(T,{}),Object(l.jsx)(C,{})]})]})};i.a.createRoot(document.getElementById("root")).render(Object(l.jsx)(a.a.StrictMode,{children:Object(l.jsx)(O,{children:Object(l.jsx)(u,{children:Object(l.jsx)(k,{children:Object(l.jsx)(M,{children:Object(l.jsx)(A,{})})})})})}))}},[[25,1,2]]]);
//# sourceMappingURL=main.5f2f1823.chunk.js.map