(this.webpackJsonpgame=this.webpackJsonpgame||[]).push([[0],{18:function(e,t,c){},20:function(e,t,c){},21:function(e,t,c){},22:function(e,t,c){},23:function(e,t,c){},24:function(e,t,c){},25:function(e,t,c){"use strict";c.r(t);var r=c(0),a=c.n(r),n=c(8),i=c.n(n),s=(c(18),c(3)),l=c(2),o=c(1),b=Object(r.createContext)();function u(e){var t=e.children,c=Object(r.useState)({}),a=Object(s.a)(c,2),n=a[0],i=a[1],u=Object(r.useState)({}),j=Object(s.a)(u,2),O=j[0],d=j[1],h=function(e){var t=Object(l.a)({},n);Object.entries(e).forEach((function(e){var c=Object(s.a)(e,2),r=c[0],a=c[1];r in t?t[r]+=a:t[r]=a})),i(t)},f=Object(r.useMemo)((function(){return{playerItems:n,playerStructures:O,setPlayerStructures:d,updateItems:h}}),[n,O]);return Object(o.jsx)(b.Provider,{value:f,children:t})}var j=c(4),O=Object(r.createContext)(),d={pickUpTrash:"Pick up trash"},h={recycler:{metal:-1},airFilter:{wood:-1},net:{plastic:-1},bridge:{wood:-1,metal:-1}},f=["trash","wood","metal","plastic"],v=["trash","plastic"],p=["wood","metal","plastic"],m=new Set(["pickUpTrash","buildRecycler","useRecycler","buildAirFilter","plantSeeds","buildNet","useNet","buildBridge"]);function g(e){var t=e.children,c=Object(r.useContext)(b),a=c.playerItems,n=c.updateItems,i=c.playerStructures,u=c.setPlayerStructures,g=Object(r.useState)(null),x=Object(s.a)(g,2),y=x[0],k=x[1],S=Object(r.useState)(d),T=Object(s.a)(S,2),C=T[0],N=T[1],w=Object(r.useState)({}),F=Object(s.a)(w,2),A=F[0],E=F[1],M=Object(r.useState)(1),R=Object(s.a)(M,2),I=R[0],U=R[1],P=Object(r.useState)(null),B=Object(s.a)(P,2),L=B[0],J=B[1],q=function(e){var t=!1;return Object.entries(h[e]).forEach((function(e){var c=Object(s.a)(e,2),r=c[0],n=c[1];a[r]+n>=0&&(t=!0)})),t};Object(r.useEffect)((function(){if(y){try{if(!m.has(y))throw Error("Unknown action: ".concat(y));switch(y){case"pickUpTrash":var e=f[Math.floor(Math.random()*f.length)],t="The surrounding area has been slightly cleared of trash";"trash"!==e&&(t="Clearing some trash has provided some useful ".concat(e)),J(t),n(Object(j.a)({},e,1));break;case"buildRecycler":u(Object(l.a)(Object(l.a)({},i),{},{recycler:!0})),J("The recycler is now operational"),n(h.recycler);break;case"useRecycler":var c,r=p[Math.floor(Math.random()*p.length)];J("Some ".concat(r," has been recycled from trash")),n((c={},Object(j.a)(c,r,1),Object(j.a)(c,"trash",-1),c));break;case"buildAirFilter":u(Object(l.a)(Object(l.a)({},i),{},{airFilter:!0})),J("An air filter has begun to reduce the amount of smog in the air"),n(h.airFilter);break;case"plantSeeds":J("The beginnings of new life have been planted");break;case"buildNet":u(Object(l.a)(Object(l.a)({},i),{},{net:!0})),J("Removing trash in the flowing river is now a possibility"),n(h.net);break;case"useNet":var a=v[Math.floor(Math.random()*v.length)];n(Object(j.a)({},a,1)),J("Some trash has been taken from the river");break;case"buildBridge":u(Object(l.a)(Object(l.a)({},i),{},{bridge:!0})),n(h.bridge),J("The river can now be crossed");break;default:throw Error("Undeveloped action: ".concat(y))}E((s=y)in A?Object(l.a)(Object(l.a)({},A),{},Object(j.a)({},s,A[s]+1)):Object(l.a)(Object(l.a)({},A),{},Object(j.a)({},s,1)))}catch(o){console.log(o)}var s;k(null)}}),[y,I]),Object(r.useEffect)((function(){N(7!==I?Object(l.a)(Object(l.a)(Object(l.a)(Object(l.a)(Object(l.a)(Object(l.a)(Object(l.a)(Object(l.a)({},(I<=2||6===I)&&{pickUpTrash:"Pick up trash"}),q("recycler")&&!i.recycler&&{buildRecycler:"Fix recycler"}),a.trash&&i.recycler&&{useRecycler:"Recycle trash"}),q("airFilter")&&!i.airFilter&&i.recycler&&2===I&&{buildAirFilter:"Construct air filter"}),3===I&&{plantSeeds:"Plant seeds"}),q("net")&&!i.net&&4===I&&{buildNet:"Construct river net"}),i.net&&4===I&&{useNet:"Filter river trash"}),q("bridge")&&5===I&&{buildBridge:"Construct a bridge"}):{})}),[a,I,i]),Object(r.useEffect)((function(){var e=I;if(1===I&&A.pickUpTrash>=10)e=2;else if(2===I&&A.pickUpTrash>=10&&i.airFilter)e=3;else if(3===I&&A.plantSeeds)e=4;else if(4===I&&A.useNet>=5)e=5;else if(5===I&&i.bridge)e=6;else{if(!(6===I&&A.pickUpTrash>=10))return;e=7,J("The area has been completely cleared of trash and pollution. Nature is finally beginning to recover.")}E({}),U(e)}),[i,I,A]);var z=Object(r.useMemo)((function(){return{currentAction:y,environmentLevel:I,availableActions:C,nextText:L,setNextText:J,setCurrentAction:k}}),[y,I,C,L]);return Object(o.jsx)(O.Provider,{value:z,children:t})}c(20);var x=function(){var e=Object(r.useContext)(b).playerItems;return 7===Object(r.useContext)(O).environmentLevel?null:Object(o.jsxs)("fieldset",{className:"inventory-container",children:[Object(o.jsx)("legend",{children:"Collection"}),Object.entries(e).map((function(e){var t=Object(s.a)(e,2),c=t[0],r=t[1];return Object(o.jsxs)("div",{className:"inventory-item",children:[Object(o.jsxs)("div",{children:[c,":\xa0"]}),Object(o.jsx)("div",{className:"item-count",children:r})]},c)}))]})};c(21);var y=function(e){var t=e.actionName,c=e.actionText,a=Object(r.useContext)(O).setCurrentAction;return Object(o.jsx)("button",{type:"button",className:"buttons shrink-on-hover",onClick:function(){return a(t)},children:c})};c(22);var k=function(){var e=Object(r.useContext)(O).availableActions,t=Object(r.useState)(!1),c=Object(s.a)(t,2),a=c[0],n=c[1];return Object(r.useEffect)((function(){var e=setTimeout((function(){n(!0)}),2500);return function(){return clearTimeout(e)}}),[]),Object(o.jsx)("div",{className:"buttons-group",style:{transition:"all 2s",visibility:a?"visible":"hidden",opacity:a?"1":"0"},children:Object.entries(e).map((function(e){var t=Object(s.a)(e,2),c=t[0],r=t[1];return Object(o.jsx)(y,{actionName:c,actionText:r},c)}))})},S=c(9),T=(c(23),["The surrounding area is piled high with trash and is extremely polluted. Smog covers the land, making the visibility almost nil."]);var C=function(){var e=Object(r.useContext)(O),t=(e.currentAction,e.nextText),c=e.setNextText,a=Object(r.useState)(T),n=Object(s.a)(a,2),i=n[0],l=n[1];return Object(r.useEffect)((function(){t&&(console.log(t),l([t].concat(Object(S.a)(i.slice(0,20)))),c(null))}),[t]),Object(o.jsx)("div",{className:"log",children:i.map((function(e,t){return Object(o.jsx)("div",{style:{opacity:(20-t)/20},children:e},t)}))})},N=Object(r.createContext)();function w(e){var t=e.children,c=Object(r.useContext)(O).environmentLevel,a=Object(r.useState)("1.jpeg"),n=Object(s.a)(a,2),i=n[0],l=n[1];Object(r.useEffect)((function(){switch(c){case 1:l("start.jpeg");break;case 2:l("initialClear.jpeg");break;case 3:l("builtAirFilter.jpeg");break;case 4:l("plantSeeds.jpeg");break;case 5:l("cleanRiver.jpeg");break;case 6:l("builtBridge.gif");break;case 7:l("final.gif")}}),[c]);var b=Object(r.useMemo)((function(){return{backgroundImage:i}}),[i]);return Object(o.jsx)(N.Provider,{value:b,children:t})}c(24);var F=function(){var e=Object(r.useContext)(N).backgroundImage;return Object(o.jsx)("div",{className:"app",style:{backgroundImage:"url(".concat("/green-room","/images/").concat(e,")")},children:Object(o.jsxs)("div",{className:"content",children:[Object(o.jsx)(C,{}),Object(o.jsx)(k,{}),Object(o.jsx)(x,{})]})})};i.a.createRoot(document.getElementById("root")).render(Object(o.jsx)(a.a.StrictMode,{children:Object(o.jsx)(u,{children:Object(o.jsx)(g,{children:Object(o.jsx)(w,{children:Object(o.jsx)(F,{})})})})}))}},[[25,1,2]]]);
//# sourceMappingURL=main.959f6c73.chunk.js.map